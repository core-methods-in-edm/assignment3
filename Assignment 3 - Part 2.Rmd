---
title: 'Assignment 3 - Part 2 - Extension Exercise'
author: "Shreya"
date: "25 October 2016"
output: html_document
---
##Extension Exercise



```{r}
install.packages("ggplot2")
install.packages("cluster")
install.packages("ggmap")

library(dplyr)
library(tidyr)
library(ggplot2)
library(cluster)
library(ggmap)

```


```{r}
P1 <- read.table("E:/TC/4050/GITHUB/assignment3/cluster-class-data.csv", header = TRUE, sep = ",")

#name the head labels in P1 data frame
names(P1) <- c("duration", "name1", "name2", "cats", "giff_jiff", "nylife", "siblings", "sports", "distancefromtc", "androidfriends", "movies", "classesthissem", "placesvisited", "city", "state", "country")
```


```{r}
#Location part

P7 <- dplyr::select(P1, city, state, country)
#select the location variables from P1 into a new data frame

#clean the data if you like. I haave just cleaned the country data. This step canbe omited.
levels(P7$country)
levels(P7$country)[levels(P7$country) == "United States "] <- "United States"
levels(P7$country)[levels(P7$country) == "United States of America"] <- "United States"
levels(P7$country)[levels(P7$country) == "The United States of America"] <- "United States"
levels(P7$country)[levels(P7$country) == "United States of America "] <- "United States"
levels(P7$country)[levels(P7$country) == "USA"] <- "United States"
levels(P7$country)[levels(P7$country) == "china"] <- "China"
levels(P7$country)[levels(P7$country) == "CHINA"] <- "China"
levels(P7$country)[levels(P7$country) == "Viet Nam "] <- "Vietnam"
levels(P7$country)[levels(P7$country) == "chile"] <- "Chile"

#change the data type of each variable to charachter
P7$country <- as.character(P7$country)
P7$state <- as.character(P7$state)
P7$city <- as.character(P7$city)

#unite all the variables under 1 variable.
P7 <- tidyr::unite(P7, location, city, state, country, sep = ",")

#use ggmap to get thelongtude and latitude of each loation.
library(ggmap)
P7 <- mutate_geocode(P7, location)

#make a new data frame that contains only thelongitude and latitude variables
P8 <- dplyr::select(P7, 2:3)

#use kmeans to make 2 clusters may be
fit <- kmeans(P8, 2)

#add a variable cluster to fit
fit$cluster

#make a new data frame that contains 
P9 <- data.frame(P8, fit$cluster)

#make the cluster plot
library(cluster)
clusplot(P9, P9$fit.cluster, labels = 2, colors = TRUE)
#name of the plot is Rplot2 - location

#add a new variable named id, 1 through 22 
P8$id <- c(1:22)
```

```{r}
#Response dataframe

#make another dataframe that contains data related to questions answered in the survey. 
P3 <- dplyr::select(P1, siblings, classesthissem, placesvisited)

#change the data typeto numeric 
P3$siblings <- as.numeric(P3$siblings)
P3$classesthissem <- as.numeric(P3$classesthissem)
P3$placesvisited <- as.numeric(P3$placesvisited)

#use kmeans tomake 4 clusters this time 
fit1 <- kmeans(P3, 4)

#add a variabe cluster
fit1$cluster
P4 <- data.frame(P3, fit1$cluster)

#plot the cluster plot
library(cluster)
clusplot(P4, P4$fit1.cluster, labels = 2, colors = TRUE)

#name of the plot is Rplot2 - responses

#add the variable id 1 through 22
P3$id <- c(1:22)
```

```{r}
#merge the 2 data frames p3 and p8 on the basis of common variable id
Q <- merge(P8, P3,by="id")

# change the dat type of id to numeric
Q$id <- as.numeric(Q$id)


fit2 <- kmeans(Q, 2)
#change the 2 above for number clusters 
fit2$cluster
q1 <- data.frame(Q, fit2$cluster)


#final clusterplot
library(cluster)
clusplot(q1, q1$fit2.cluster, labels = 2, colors = TRUE)

#name of the plot is Rplot2 - location+responses
```


1. see how we did not change the data type to numeric in location cluster and we had to in the response data frame. this is because longitude and latitude are already in numeric format in location data frame


2. location cluster plot reveals how the locations of the participants have been divided into 2 groups or clusters

3. response cluster plot reveals the 4 cluster based the response types chosen

4. the final cluster is the integration of the location as well as the responses into 2 clusters.

```{r}
#install thepackage vcd
install.packages("vcd", dependencies = TRUE)
library(vcd)

#plot q1
mosaicplot(q1, main = deparse(substitute(q1)), sub = NULL, xlab = NULL, ylab = NULL, sort = NULL, off = NULL, dir = NULL, color = blues9, shade = FALSE, margin = NULL, cex.axis = 0.6, las = par("las"), border = NULL, type = c("pearson", "deviance", "FT"))


#name of the plot is Rplot2-mosaicplot
```


Done my best..!! I know improvement is always possible, and would love to learn some
:D